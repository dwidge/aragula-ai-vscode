<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ask AI</title>
    <link rel="stylesheet" href="chatview.css" />
  </head>
  <body ondragover="allowDrop(event)" ondrop="dropHandler(event)">
    <main>
      <div id="enabled-tools-container"></div>
      <div id="tool-popup" class="tool-popup">
        <ul id="tool-popup-list" class="tool-list"></ul>
      </div>

      <div id="selected-provider-container"></div>
      <div id="provider-popup" class="provider-popup">
        <div class="provider-popup-header">
          <span>Providers</span>
          <button
            class="add-provider-button"
            title="Add New Provider"
            onclick="handleAddProviderButton()"
          >
            +
          </button>
        </div>
        <ul id="provider-popup-list" class="provider-list"></ul>

        <div id="provider-form" class="provider-form">
          <h3>Add/Edit Provider</h3>
          <label for="provider-name">Name:</label>
          <input
            type="text"
            id="provider-name"
            class="form-input"
            placeholder="Provider Name"
          />
          <div class="error-message-inline" id="provider-name-error"></div>

          <label for="provider-vendor">Vendor:</label>
          <select id="provider-vendor" class="form-input">
            <option value="">Select Vendor</option>
          </select>
          <div class="error-message-inline" id="provider-vendor-error"></div>

          <label for="provider-apiKey">API Key:</label>
          <input
            type="text"
            id="provider-apiKey"
            class="form-input"
            placeholder="API Key"
          />
          <div class="error-message-inline" id="provider-apiKey-error"></div>

          <label for="provider-baseURL">Base URL (optional):</label>
          <input
            type="text"
            id="provider-baseURL"
            class="form-input"
            placeholder="Base URL (for custom servers)"
          />
          <div class="error-message-inline" id="provider-baseURL-error"></div>

          <label for="provider-model">Model:</label>
          <input
            type="text"
            id="provider-model"
            class="form-input"
            placeholder="Model Name (e.g., gpt-4, claude-v1.3)"
          />
          <div class="error-message-inline" id="provider-model-error"></div>

          <label for="provider-provider">Provider (optional):</label>
          <input
            type="text"
            id="provider-provider"
            class="form-input"
            placeholder="Provider (e.g., cerebras, samba)"
          />
          <div class="error-message-inline" id="provider-provider-error"></div>

          <label for="provider-maxTokens">Max Tokens (optional):</label>
          <input
            type="number"
            id="provider-maxTokens"
            class="form-input"
            placeholder="Max Tokens"
          />
          <div class="error-message-inline" id="provider-maxTokens-error"></div>

          <label for="provider-temperature">Temperature (optional, 0-2):</label>
          <input
            type="number"
            id="provider-temperature"
            class="form-input"
            placeholder="Temperature (e.g., 0.7)"
            step="0.1"
            min="0"
            max="2"
          />
          <div
            class="error-message-inline"
            id="provider-temperature-error"
          ></div>

          <div class="provider-form-buttons">
            <button onclick="handleSaveProviderSettings()">Save</button>
            <button onclick="handleCancelProviderSettings()">Cancel</button>
          </div>
        </div>
      </div>

      <div id="selected-files-container"></div>
      <div class="input-area">
        <div class="input-row">
          <textarea
            id="systemPromptInput"
            rows="2"
            placeholder="Edit system prompt here..."
          ></textarea>
          <div class="prompt-buttons">
            <button onclick="toggleSystemPromptsPopup()">Load</button>
            <button onclick="addSystemPromptToLibrary()">Save</button>
          </div>
        </div>
        <div id="system-prompts-popup" class="prompt-popup">
          <ul id="system-prompts-popup-list" class="prompts-list"></ul>
        </div>

        <div class="input-row">
          <textarea
            id="userInput"
            rows="4"
            placeholder="Type your message here..."
          ></textarea>
          <div class="prompt-buttons">
            <button onclick="toggleUserPromptsPopup()">Load</button>
            <button onclick="addUserPromptToLibrary()">Save</button>
          </div>
        </div>
        <div id="user-prompts-popup" class="prompt-popup">
          <ul id="user-prompts-popup-list" class="prompts-list"></ul>
        </div>

        <div class="input-row">
          <input
            type="text"
            id="runCommandInput"
            class="form-input"
            placeholder="Enter command to run..."
          />
          <select id="shellSelector" class="form-input"></select>
          <button id="runCommandButton" onclick="handleRunCommand()">
            <span id="runCommandButtonText">Run</span>
            <span
              id="runCommandLoader"
              class="loader"
              style="display: none"
              title="Running..."
            ></span>
          </button>
        </div>

        <div class="button-row">
          <button id="sendButton" onclick="handleSendMessage()">
            <span id="buttonText">Send</span>
            <span id="loader" class="loader" style="display: none"></span>
          </button>
          <button id="planButton" onclick="handlePlanAndExecute()">
            <span id="planButtonText">Plan & Execute</span>
            <span id="planLoader" class="loader" style="display: none"></span>
          </button>
          <button id="clearButton" onclick="clearChatHistory()">Clear</button>
          <button id="addFilesButton" onclick="addFilesDialog()">
            Add Files
          </button>
          <button id="addToolButton" onclick="toggleToolPopup()">
            Add Tool
          </button>
          <button
            id="providerSettingsButton"
            onclick="toggleProviderSettingsPopup()"
          >
            Providers
          </button>
          <div class="auto-checkbox">
            <input type="checkbox" id="autoRemoveCommentsCheckbox" />
            <label for="autoRemoveCommentsCheckbox">Auto Remove Comments</label>
          </div>
          <button id="removeCommentsButton" onclick="handleRemoveComments()">
            Remove Comments
          </button>
          <div class="auto-checkbox">
            <input type="checkbox" id="autoFormatCheckbox" />
            <label for="autoFormatCheckbox">Auto Format</label>
          </div>
          <button id="formatButton" onclick="handleFormat()">Format</button>
          <div class="auto-checkbox">
            <input type="checkbox" id="autoFixErrorsCheckbox" />
            <label for="autoFixErrorsCheckbox">Auto Fix Errors</label>
          </div>
          <button id="fixErrorsButton" onclick="handleFixErrors()">
            Fix Errors
          </button>
          <div class="auto-checkbox">
            <input type="checkbox" id="autoGenerateCommitCheckbox" />
            <label for="autoGenerateCommitCheckbox"
              >Generate Commit Message</label
            >
          </div>
          <div class="auto-checkbox">
            <input type="checkbox" id="useConventionalCommitsCheckbox" />
            <label for="useConventionalCommitsCheckbox"
              >Use Conventional Commits</label
            >
          </div>
          <button id="commitFilesButton" onclick="handleCommitFiles()">
            Commit Files
          </button>
          <!-- New Commit Files Button -->
          <button id="testTaskButton" onclick="handleTestTask()">
            Test Task Logger
          </button>
          <!-- New Test Task Logger Button -->
          <button id="testMultiTaskButton" onclick="handleTestMultiTask()">
            Test Multi Task
          </button>
          <!-- New Test Multi Task Button -->
          <button id="testSerialTaskButton" onclick="handleTestSerialTask()">
            Test Serial Task
          </button>
          <!-- New Test Serial Task Button -->
          <button id="testFormTaskButton" onclick="handleTestFormTask()">
            Test Form Task
          </button>
          <!-- New Test Form Task Button -->
          <button
            id="testSetCommitMessageButton"
            onclick="handleTestSetCommitMessage()"
          >
            Test Set Commit Message
          </button>
          <button
            id="showCodebaseSummaryButton"
            onclick="handleShowCodebaseSummary()"
          >
            Show Codebase Summary
          </button>
          <div class="auto-checkbox">
            <input type="checkbox" id="includeCodebaseSummaryCheckbox" />
            <label for="includeCodebaseSummaryCheckbox"
              >Include Codebase Summary</label
            >
          </div>
          <button
            id="privacySettingsButton"
            onclick="togglePrivacySettingsPopup()"
          >
            Privacy
          </button>
        </div>
      </div>

      <div id="privacy-popup" class="privacy-popup">
        <div class="privacy-popup-header">
          <span>Privacy Settings</span>
          <button
            class="add-privacy-pair-button"
            title="Add New Replacement Pair"
            onclick="handleAddPrivacyPairButton()"
          >
            +
          </button>
        </div>
        <div class="auto-checkbox" style="margin-bottom: 10px">
          <input type="checkbox" id="isPrivacyMaskingEnabledCheckbox" />
          <label for="isPrivacyMaskingEnabledCheckbox"
            >Enable Data Masking</label
          >
        </div>
        <ul id="privacy-popup-list" class="privacy-list"></ul>

        <div id="privacy-form" class="privacy-form" style="display: none">
          <h3>Add/Edit Replacement Pair</h3>
          <label for="privacy-search">Sensitive String (Search):</label>
          <input
            type="text"
            id="privacy-search"
            class="form-input"
            placeholder="String to replace (e.g., your_api_key)"
          />
          <div class="error-message-inline" id="privacy-search-error"></div>

          <label for="privacy-replace">Dummy Placeholder (Replace):</label>
          <input
            type="text"
            id="privacy-replace"
            class="form-input"
            placeholder="Replacement string (e.g., DUMMY_API_KEY_1)"
          />
          <div class="error-message-inline" id="privacy-replace-error"></div>

          <div class="privacy-form-buttons">
            <button onclick="handleSavePrivacyPair()">Save</button>
            <button onclick="handleCancelPrivacyPair()">Cancel</button>
          </div>
        </div>
      </div>

      <div id="messages-container"></div>
    </main>
    <script type="module" src="chatview.js"></script>
  </body>
</html>
